{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{GLOBALTYPES}from\"../../redux/actions/globalTypes\";// import { ToastContainer, toast } from \"react-toastify\";\nimport Avatar from\"../Avatar\";import{Link}from\"react-router-dom\";import{useSelector,useDispatch}from\"react-redux\";import{Button}from\"@material-ui/core\";import FindButton from\"./FindButton\";import CommonLikedPosts from\"./CommonLikedPosts\";import UserCard from\"../UserCard\";import ComponentToast from\"../ComponentToast\";import{createRequest,acceptMatchRequest}from\"../../redux/actions/matchRequestAction\";import{getProfileUsers,follow}from\"../../redux/actions/profileAction\";import{getDataAPI}from\"../../utils/fetchData\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AnanomUserCard=function AnanomUserCard(props){var _useSelector=useSelector(function(state){return state;}),theme=_useSelector.theme,auth=_useSelector.auth,socket=_useSelector.socket,profile=_useSelector.profile;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),accepted=_useState2[0],setAccepted=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),userData=_useState4[0],setUserData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),onEdit=_useState6[0],setOnEdit=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),fetchProfile=_useState8[0],setFetchProfile=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),followUser=_useState10[0],setFollowUser=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),match=_useState12[0],setMatch=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),received=_useState14[0],setReceived=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),sent=_useState16[0],setSent=_useState16[1];var _useState17=useState({}),_useState18=_slicedToArray(_useState17,2),user=_useState18[0],setUser=_useState18[1];var dispatch=useDispatch();var ananomId=props.ananomId;console.log(ananomId);//sockets\nsocket.on(\"requestmatchToClient\",function(data){console.log(data);setReceived(true);/*#__PURE__*/_jsx(ComponentToast,{theme:\"Error\",Component:RequestMatchNotif});});socket.on(\"makeMatchToClient\",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(data);setMatch(true);dispatch({type:GLOBALTYPES.AUTH,payload:_objectSpread(_objectSpread({},auth),{},{user:_objectSpread(_objectSpread({},auth.user),{},{matches:[].concat(_toConsumableArray(auth.user.matches),[ananomId])})})});setAccepted(true);setFetchProfile(true);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());socket.on(\"rejectMatchToClient\",function(data){console.log(data);setSent(false);});// socket region end\n// Toast Container\nvar RequestMatchNotif=function RequestMatchNotif(){return/*#__PURE__*/_jsxs(\"div\",{children:[console.log(\"requested\"),\"The user you are talking to has sent you connection request.\",/*#__PURE__*/_jsx(Button,{onClick:AcceptHandler,children:\"Accept Request\"}),\" \"]});};var AcceptMatchNotif=function AcceptMatchNotif(){return/*#__PURE__*/_jsxs(\"div\",{children:[console.log(\"accepted\"),\"Whooray, we have a new match\",/*#__PURE__*/_jsx(UserCard,{user:user,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-circle\"})})]});};// ToastContainer ended\nuseEffect(function(){var myfunc=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getDataAPI(\"user/\".concat(ananomId),auth.token);case 2:res=_context2.sent;user=res.data.user;setUser(user);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function myfunc(){return _ref2.apply(this,arguments);};}();myfunc();},[]);useEffect(function(){var isRequested=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res,user;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getDataAPI(\"user/\".concat(ananomId),auth.token);case 2:res=_context3.sent;user=res.data.user;setUser(user);try{auth.user.matches.forEach(function(item){if(item===ananomId){setMatch(true);}});}catch(error){console.log(error);}case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function isRequested(){return _ref3.apply(this,arguments);};}();isRequested();},[]);useEffect(function(){if(props.receiver===auth.user._id){setUserData([auth.user]);}else{var newData=profile.users.filter(function(user){return user._id===props.receiver;});setUserData(newData);}},[props.receiver,auth,dispatch,profile.users]);var onMatchHandler=function onMatchHandler(){dispatch(createRequest({sender:auth.user._id,receiver:props.receiver,auth:auth,socket:socket,user:auth.user}));setSent(true);};var AcceptHandler=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return dispatch(acceptMatchRequest({auth:auth,socket:socket,sender:props.receiver,receiver:auth.user._id}));case 2:setMatch(true);setFetchProfile(true);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function AcceptHandler(){return _ref4.apply(this,arguments);};}();// useEffect(() => {\n//   if (fetchProfile) {\n//     dispatch(getProfileUsers({ id: props.receiver, auth }));\n//   }\n//   setFetchProfile(false);\n//   setFollowUser(true);\n// }, [fetchProfile]);\n// useEffect(() => {\n//   if (followUser) {\n//     dispatch(\n//       follow({ users: profile.users, user: userData[0], auth, socket })\n//     );\n//   }\n//   setFollowUser(false);\n// }, [followUser]);\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between p-2 w-100 align-items-center\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\"//   onClick={handleCloseAll}\n,className:\"d-flex align-items-center\",style:{textDecoration:\"none\"},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"outer-shadow big-avatar-cover \",children:/*#__PURE__*/_jsx(Avatar,{src:\"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\",size:\"big-avatar\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"ms-2\",style:{transform:\"translateY(-2px)\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"d-block color-c2\",children:\"Ananomous User\"})})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-1 outer-shadow hover-in-shadow\",onClick:function onClick(){return setOnEdit(true);},children:\"Common Interests\"}),match&&/*#__PURE__*/_jsx(Button,{children:\"Match already\"}),!match&&received&&!sent&&/*#__PURE__*/_jsx(Button,{onClick:AcceptHandler,children:\"Accept Request\"}),!match&&!received&&sent&&/*#__PURE__*/_jsx(Button,{children:\"Pending...\"}),!match&&!received&&!sent&&/*#__PURE__*/_jsx(Button,{onClick:onMatchHandler,children:\"Match Request\"}),/*#__PURE__*/_jsx(FindButton,{find:props.find,setFind:props.setFind,end:props.end,setEnd:props.setEnd,bcode:props.bcode,setBcode:props.setBcode}),received&&/*#__PURE__*/_jsx(ComponentToast,{theme:\"Success\",Component:RequestMatchNotif}),accepted&&/*#__PURE__*/_jsx(ComponentToast,{theme:\"Success\",Component:AcceptMatchNotif}),onEdit&&/*#__PURE__*/_jsx(CommonLikedPosts,{setOnEdit:setOnEdit,receiver:props.receiver})]});};export default AnanomUserCard;","map":{"version":3,"sources":["C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/src/components/AnanomousUser/AnanomUserCard.js"],"names":["React","useState","useEffect","GLOBALTYPES","Avatar","Link","useSelector","useDispatch","Button","FindButton","CommonLikedPosts","UserCard","ComponentToast","createRequest","acceptMatchRequest","getProfileUsers","follow","getDataAPI","AnanomUserCard","props","state","theme","auth","socket","profile","accepted","setAccepted","userData","setUserData","onEdit","setOnEdit","fetchProfile","setFetchProfile","followUser","setFollowUser","match","setMatch","received","setReceived","sent","setSent","user","setUser","dispatch","ananomId","console","log","on","data","RequestMatchNotif","type","AUTH","payload","matches","AcceptHandler","AcceptMatchNotif","myfunc","token","res","isRequested","forEach","item","error","receiver","_id","newData","users","filter","onMatchHandler","sender","textDecoration","transform","find","setFind","end","setEnd","bcode","setBcode"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { GLOBALTYPES } from \"../../redux/actions/globalTypes\";\r\n\r\n// import { ToastContainer, toast } from \"react-toastify\";\r\n\r\nimport Avatar from \"../Avatar\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Button } from \"@material-ui/core\";\r\n\r\nimport FindButton from \"./FindButton\";\r\nimport CommonLikedPosts from \"./CommonLikedPosts\";\r\nimport UserCard from \"../UserCard\";\r\nimport ComponentToast from \"../ComponentToast\";\r\nimport {\r\n  createRequest,\r\n  acceptMatchRequest,\r\n} from \"../../redux/actions/matchRequestAction\";\r\n\r\nimport { getProfileUsers, follow } from \"../../redux/actions/profileAction\";\r\nimport { getDataAPI } from \"../../utils/fetchData\";\r\n\r\nconst AnanomUserCard = (props) => {\r\n  const { theme, auth, socket, profile } = useSelector((state) => state);\r\n  const [accepted, setAccepted] = useState(false);\r\n  const [userData, setUserData] = useState([]);\r\n  const [onEdit, setOnEdit] = useState(false);\r\n  const [fetchProfile, setFetchProfile] = useState(false);\r\n  const [followUser, setFollowUser] = useState(false);\r\n  const [match, setMatch] = useState(false);\r\n  const [received, setReceived] = useState(false);\r\n  const [sent, setSent] = useState(false);\r\n  const [user, setUser] = useState({});\r\n  const dispatch = useDispatch();\r\n  const { ananomId } = props;\r\n  console.log(ananomId);\r\n\r\n  //sockets\r\n  socket.on(\"requestmatchToClient\", (data) => {\r\n    console.log(data);\r\n    setReceived(true);\r\n    <ComponentToast theme=\"Error\" Component={RequestMatchNotif} />;\r\n  });\r\n\r\n  socket.on(\"makeMatchToClient\", async (data) => {\r\n    console.log(data);\r\n    setMatch(true);\r\n    dispatch({\r\n      type: GLOBALTYPES.AUTH,\r\n      payload: {\r\n        ...auth,\r\n        user: { ...auth.user, matches: [...auth.user.matches, ananomId] },\r\n      },\r\n    });\r\n    setAccepted(true);\r\n    setFetchProfile(true);\r\n  });\r\n\r\n  socket.on(\"rejectMatchToClient\", (data) => {\r\n    console.log(data);\r\n    setSent(false);\r\n  });\r\n\r\n  // socket region end\r\n\r\n  // Toast Container\r\n  const RequestMatchNotif = () => (\r\n    <div>\r\n      {console.log(\"requested\")}\r\n      The user you are talking to has sent you connection request.\r\n      <Button onClick={AcceptHandler}>Accept Request</Button>{\" \"}\r\n    </div>\r\n  );\r\n\r\n  const AcceptMatchNotif = () => (\r\n    <div>\r\n      {console.log(\"accepted\")}\r\n      Whooray, we have a new match\r\n      <UserCard user={user}>\r\n        <i className=\"fas fa-circle\" />\r\n      </UserCard>\r\n    </div>\r\n  );\r\n\r\n  // ToastContainer ended\r\n\r\n  useEffect(() => {\r\n    const myfunc = async () => {\r\n      const res = await getDataAPI(`user/${ananomId}`, auth.token);\r\n      const user = res.data.user;\r\n      setUser(user);\r\n    };\r\n    myfunc();\r\n  }, []);\r\n\r\n\r\n  useEffect(() => {\r\n    const isRequested = async () => {\r\n      const res = await getDataAPI(`user/${ananomId}`, auth.token);\r\n      const user = res.data.user;\r\n      setUser(user);\r\n      try {\r\n        auth.user.matches.forEach((item) => {\r\n          if (item === ananomId) {\r\n            setMatch(true);\r\n          }\r\n        });\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    isRequested();\r\n  }, []);\r\n\r\n\r\n  useEffect(() => {\r\n    if (props.receiver === auth.user._id) {\r\n      setUserData([auth.user]);\r\n    } else {\r\n      const newData = profile.users.filter(\r\n        (user) => user._id === props.receiver\r\n      );\r\n      setUserData(newData);\r\n    }\r\n  }, [props.receiver, auth, dispatch, profile.users]);\r\n\r\n  const onMatchHandler = () => {\r\n    dispatch(\r\n      createRequest({\r\n        sender: auth.user._id,\r\n        receiver: props.receiver,\r\n        auth,\r\n        socket,\r\n        user: auth.user,\r\n      })\r\n    );\r\n    setSent(true);\r\n  };\r\n\r\n  const AcceptHandler = async () => {\r\n    await dispatch(\r\n      acceptMatchRequest({\r\n        auth,\r\n        socket,\r\n        sender: props.receiver,\r\n        receiver: auth.user._id,\r\n      })\r\n    );\r\n    setMatch(true);\r\n    setFetchProfile(true);\r\n  };\r\n\r\n  // useEffect(() => {\r\n  //   if (fetchProfile) {\r\n  //     dispatch(getProfileUsers({ id: props.receiver, auth }));\r\n  //   }\r\n  //   setFetchProfile(false);\r\n  //   setFollowUser(true);\r\n  // }, [fetchProfile]);\r\n\r\n  // useEffect(() => {\r\n  //   if (followUser) {\r\n  //     dispatch(\r\n  //       follow({ users: profile.users, user: userData[0], auth, socket })\r\n  //     );\r\n  //   }\r\n  //   setFollowUser(false);\r\n  // }, [followUser]);\r\n\r\n  return (\r\n    <div\r\n      className={`d-flex justify-content-between p-2 w-100 align-items-center`}\r\n    >\r\n      <Link\r\n        to={`/`}\r\n        //   onClick={handleCloseAll}\r\n        className=\"d-flex align-items-center\"\r\n        style={{ textDecoration: \"none\" }}\r\n      >\r\n        <div>\r\n          <div className=\"outer-shadow big-avatar-cover \">\r\n            <Avatar\r\n              src={\r\n                \"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\"\r\n              }\r\n              size=\"big-avatar\"\r\n            />\r\n          </div>\r\n          <div className=\"ms-2\" style={{ transform: \"translateY(-2px)\" }}>\r\n            <span className=\"d-block color-c2\">{\"Ananomous User\"}</span>\r\n          </div>\r\n        </div>\r\n      </Link>\r\n      <button\r\n        className=\"btn-1 outer-shadow hover-in-shadow\"\r\n        onClick={() => setOnEdit(true)}\r\n      >\r\n        Common Interests\r\n      </button>\r\n      {match && <Button>Match already</Button>}\r\n      {!match && received && !sent && (\r\n        <Button onClick={AcceptHandler}>Accept Request</Button>\r\n      )}\r\n      {!match && !received && sent && <Button>Pending...</Button>}\r\n\r\n      {!match && !received && !sent && (\r\n        <Button onClick={onMatchHandler}>Match Request</Button>\r\n      )}\r\n      <FindButton\r\n        find={props.find}\r\n        setFind={props.setFind}\r\n        end={props.end}\r\n        setEnd={props.setEnd}\r\n        bcode={props.bcode}\r\n        setBcode={props.setBcode}\r\n      />\r\n\r\n      {/* <ToastContainer></ToastContainer> */}\r\n      {received && (\r\n        <ComponentToast theme=\"Success\" Component={RequestMatchNotif} />\r\n      )}\r\n      {accepted && (\r\n        <ComponentToast theme=\"Success\" Component={AcceptMatchNotif} />\r\n      )}\r\n      {onEdit && (\r\n        <CommonLikedPosts setOnEdit={setOnEdit} receiver={props.receiver} />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AnanomUserCard;\r\n"]},"metadata":{},"sourceType":"module"}