{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{ToastContainer,toast}from\"react-toastify\";import Avatar from\"../Avatar\";import{Link}from\"react-router-dom\";import{useSelector,useDispatch}from\"react-redux\";import{Button}from\"@material-ui/core\";import FindButton from\"./FindButton\";import CommonLikedPosts from\"./CommonLikedPosts\";import UserCard from\"../UserCard\";import{createRequest,acceptMatchRequest}from\"../../redux/actions/matchRequestAction\";import{getDataAPI}from\"../../utils/fetchData\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AnanomUserCard=function AnanomUserCard(props){var _useSelector=useSelector(function(state){return state;}),theme=_useSelector.theme,auth=_useSelector.auth,socket=_useSelector.socket;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),onEdit=_useState2[0],setOnEdit=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),match=_useState4[0],setMatch=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),received=_useState6[0],setReceived=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),sent=_useState8[0],setSent=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),user=_useState10[0],setUser=_useState10[1];var dispatch=useDispatch();var ananomId=props.ananomId;console.log(ananomId);var RequestMatchNotif=function RequestMatchNotif(){return/*#__PURE__*/_jsxs(\"div\",{children:[\"The user you are talking to has sent you connection request.\",/*#__PURE__*/_jsx(Button,{onClick:AcceptHandler,children:\"Accept Request\"}),\" \"]});};var AcceptMatchNotif=function AcceptMatchNotif(_ref){var user=_ref.user;return/*#__PURE__*/_jsxs(\"div\",{children:[\"Whooray, we have a new match\",/*#__PURE__*/_jsx(UserCard,{user:user,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-circle\"})})]});};socket.on(\"requestmatchToClient\",function(data){console.log(data);setReceived(true);toast(/*#__PURE__*/_jsx(RequestMatchNotif,{}),{theme:\"colored\",autoClose:10000});});socket.on(\"makeMatchToClient\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var res,_user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(data);setMatch(true);if(user._id){_context.next=10;break;}_context.next=5;return getDataAPI(\"user/\".concat(ananomId),auth.token);case 5:res=_context.sent;_user=res.data.user;setUser(_user);console.log(res);toast.success(/*#__PURE__*/_jsx(AcceptMatchNotif,{user:_user}),{theme:\"colored\",autoClose:10000});case 10:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());socket.on(\"rejectMatchToClient\",function(data){console.log(data);setSent(false);});useEffect(function(){var isRequested=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:try{auth.user.matches.forEach(function(item){if(item===ananomId){setMatch(true);}});}catch(error){console.log(error);}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function isRequested(){return _ref3.apply(this,arguments);};}();isRequested();},[]);var onMatchHandler=function onMatchHandler(){dispatch(createRequest({sender:auth.user._id,receiver:props.receiver,auth:auth,socket:socket,user:auth.user}));setSent(true);};var AcceptHandler=function AcceptHandler(){dispatch(acceptMatchRequest({auth:auth,socket:socket,sender:props.receiver,receiver:auth.user._id}));setMatch(true);};return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between p-2 w-100 align-items-center\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\"//   onClick={handleCloseAll}\n,className:\"d-flex align-items-center\",style:{textDecoration:\"none\"},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"outer-shadow big-avatar-cover \",children:/*#__PURE__*/_jsx(Avatar,{src:\"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\",size:\"big-avatar\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"ms-2\",style:{transform:\"translateY(-2px)\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"d-block color-c2\",children:\"Ananomous User\"})})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-1 outer-shadow hover-in-shadow\",onClick:function onClick(){return setOnEdit(true);},children:\"Common Interests\"}),match&&/*#__PURE__*/_jsx(Button,{children:\"Match already\"}),!match&&received&&!sent&&/*#__PURE__*/_jsx(Button,{onClick:AcceptHandler,children:\"Accept Request\"}),!match&&!received&&sent&&/*#__PURE__*/_jsx(Button,{children:\"Pending...\"}),!match&&!received&&!sent&&/*#__PURE__*/_jsx(Button,{onClick:onMatchHandler,children:\"Match Request\"}),/*#__PURE__*/_jsx(FindButton,{find:props.find,setFind:props.setFind,end:props.end,setEnd:props.setEnd,bcode:props.bcode,setBcode:props.setBcode}),/*#__PURE__*/_jsx(ToastContainer,{}),onEdit&&/*#__PURE__*/_jsx(CommonLikedPosts,{setOnEdit:setOnEdit,receiver:props.receiver})]});};export default AnanomUserCard;","map":{"version":3,"sources":["C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/src/components/AnanomousUser/AnanomUserCard.js"],"names":["React","useState","useEffect","ToastContainer","toast","Avatar","Link","useSelector","useDispatch","Button","FindButton","CommonLikedPosts","UserCard","createRequest","acceptMatchRequest","getDataAPI","AnanomUserCard","props","state","theme","auth","socket","onEdit","setOnEdit","match","setMatch","received","setReceived","sent","setSent","user","setUser","dispatch","ananomId","console","log","RequestMatchNotif","AcceptHandler","AcceptMatchNotif","on","data","autoClose","_id","token","res","success","isRequested","matches","forEach","item","error","onMatchHandler","sender","receiver","textDecoration","transform","find","setFind","end","setEnd","bcode","setBcode"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\n\r\nimport Avatar from \"../Avatar\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Button } from \"@material-ui/core\";\r\n\r\nimport FindButton from \"./FindButton\";\r\nimport CommonLikedPosts from \"./CommonLikedPosts\";\r\nimport UserCard from \"../UserCard\"\r\nimport {\r\n  createRequest,\r\n  acceptMatchRequest,\r\n} from \"../../redux/actions/matchRequestAction\";\r\nimport { getDataAPI } from \"../../utils/fetchData\";\r\n\r\nconst AnanomUserCard = (props) => {\r\n  const { theme, auth, socket } = useSelector((state) => state);\r\n  const [onEdit, setOnEdit] = useState(false);\r\n  const [match, setMatch] = useState(false);\r\n  const [received, setReceived] = useState(false);\r\n  const [sent, setSent] = useState(false);\r\n  const [user, setUser] = useState({});\r\n  const dispatch = useDispatch();\r\n  const { ananomId } = props;\r\n  console.log(ananomId);\r\n\r\n  const RequestMatchNotif = () => (\r\n    <div>\r\n      The user you are talking to has sent you connection request.\r\n      <Button onClick={AcceptHandler}>Accept Request</Button>{\" \"}\r\n    </div>\r\n  );\r\n\r\n  const AcceptMatchNotif = ( {user} ) => (\r\n    <div>\r\n      Whooray, we have a new match\r\n      <UserCard user={user}>\r\n        <i className=\"fas fa-circle\" />\r\n      </UserCard>\r\n    </div>\r\n  );\r\n\r\n    socket.on(\"requestmatchToClient\", (data) => {\r\n      console.log(data);\r\n      setReceived(true);\r\n      toast(<RequestMatchNotif />, {\r\n        theme: \"colored\",\r\n        autoClose: 10000,\r\n      });\r\n    });\r\n\r\n    socket.on(\"makeMatchToClient\", async(data) => {\r\n      console.log(data);\r\n      setMatch(true);\r\n      if (!user._id) {\r\n        const res = await getDataAPI(`user/${ananomId}`, auth.token);\r\n        const user = res.data.user;\r\n        setUser(user);\r\n        console.log(res);\r\n        toast.success(<AcceptMatchNotif user={user} />, {\r\n          theme: \"colored\",\r\n          autoClose: 10000,\r\n        });\r\n      }\r\n    });\r\n\r\n    socket.on(\"rejectMatchToClient\", (data) => {\r\n      console.log(data);\r\n      setSent(false);\r\n    });\r\n\r\n  useEffect(() => {\r\n    const isRequested = async () => {\r\n      try {\r\n        auth.user.matches.forEach((item) => {\r\n          if (item === ananomId) {\r\n            setMatch(true);\r\n          }\r\n        });\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    isRequested();\r\n  }, []);\r\n\r\n  const onMatchHandler = () => {\r\n    dispatch(\r\n      createRequest({\r\n        sender: auth.user._id,\r\n        receiver: props.receiver,\r\n        auth,\r\n        socket,\r\n        user: auth.user,\r\n      })\r\n    );\r\n    setSent(true);\r\n  };\r\n\r\n  const AcceptHandler = () => {\r\n    dispatch(acceptMatchRequest({auth, socket, sender:props.receiver, receiver:auth.user._id}));\r\n    setMatch(true);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={`d-flex justify-content-between p-2 w-100 align-items-center`}\r\n    >\r\n      <Link\r\n        to={`/`}\r\n        //   onClick={handleCloseAll}\r\n        className=\"d-flex align-items-center\"\r\n        style={{ textDecoration: \"none\" }}\r\n      >\r\n        <div>\r\n          <div className=\"outer-shadow big-avatar-cover \">\r\n            <Avatar\r\n              src={\r\n                \"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\"\r\n              }\r\n              size=\"big-avatar\"\r\n            />\r\n          </div>\r\n          <div className=\"ms-2\" style={{ transform: \"translateY(-2px)\" }}>\r\n            <span className=\"d-block color-c2\">{\"Ananomous User\"}</span>\r\n          </div>\r\n        </div>\r\n      </Link>\r\n      <button\r\n        className=\"btn-1 outer-shadow hover-in-shadow\"\r\n        onClick={() => setOnEdit(true)}\r\n      >\r\n        Common Interests\r\n      </button>\r\n      {match && <Button>Match already</Button>}\r\n      {!match && received && !sent && (\r\n        <Button onClick={AcceptHandler}>Accept Request</Button>\r\n      )}\r\n      {!match && !received && sent && <Button>Pending...</Button>}\r\n\r\n      {!match && !received && !sent && (\r\n        <Button onClick={onMatchHandler}>Match Request</Button>\r\n      )}\r\n      <FindButton\r\n        find={props.find}\r\n        setFind={props.setFind}\r\n        end={props.end}\r\n        setEnd={props.setEnd}\r\n        bcode={props.bcode}\r\n        setBcode={props.setBcode}\r\n      />\r\n\r\n      <ToastContainer></ToastContainer>\r\n\r\n      {onEdit && (\r\n        <CommonLikedPosts setOnEdit={setOnEdit} receiver={props.receiver} />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AnanomUserCard;\r\n"]},"metadata":{},"sourceType":"module"}