{"ast":null,"code":"import _toConsumableArray from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{GLOBALTYPES}from\"./globalTypes\";import{postDataAPI,getDataAPI,patchDataAPI,deleteDataAPI}from\"../../utils/fetchData\";import{imageUpload}from\"../../utils/imageUpload\";import{createNotify,removeNotify}from\"./notifyAction\";export var POST_TYPES={CREATE_POST:\"CREATE_POST\",LOADING_POST:\"LOADING_POST\",GET_POSTS:\"GET_POSTS\",UPDATE_POST:\"UPDATE_POST\",GET_POST:\"GET_POST\",DELETE_POST:\"DELETE_POST\",REPORT_POST:\"REPORT_POST\",SAVE_POST:\"SAVE_POST\"};export var createPost=function createPost(_ref){var content=_ref.content,images=_ref.images,auth=_ref.auth,socket=_ref.socket;return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var media,res,msg;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:media=[];_context.prev=1;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});if(!(images.length>0)){_context.next=7;break;}_context.next=6;return imageUpload(images);case 6:media=_context.sent;case 7:_context.next=9;return postDataAPI(\"posts\",{content:content,images:media},auth.token);case 9:res=_context.sent;dispatch({type:POST_TYPES.CREATE_POST,payload:_objectSpread(_objectSpread({},res.data.newPost),{},{user:auth.user})});dispatch({type:GLOBALTYPES.ALERT,payload:{loading:false}});// todo notification\nmsg={id:res.data.newPost._id,text:\"Added a new post.\",recipients:res.data.newPost.user.followers,url:\"/post/\".concat(res.data.newPost._id),content:content,image:media[0].url};dispatch(createNotify({msg:msg,auth:auth,socket:socket}));_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](1);console.log(_context.t0);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context.t0.response.data.msg}});case 20:case\"end\":return _context.stop();}}},_callee,null,[[1,16]]);}));return function(_x){return _ref2.apply(this,arguments);};}();};export var getPosts=function getPosts(token){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(token);_context2.prev=1;dispatch({type:POST_TYPES.LOADING_POST,payload:true});_context2.next=5;return getDataAPI(\"posts\",token);case 5:res=_context2.sent;console.log(res);dispatch({type:POST_TYPES.GET_POSTS,payload:_objectSpread(_objectSpread({},res.data),{},{page:2})});dispatch({type:POST_TYPES.LOADING_POST,payload:false});_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context2.t0.response.data.msg}});case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[1,11]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};export var updatePost=function updatePost(_ref4){var content=_ref4.content,images=_ref4.images,auth=_ref4.auth,status=_ref4.status;return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var media,imgNewUrl,imgOldUrl,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:media=[];imgNewUrl=images.filter(function(img){return!img.url;});imgOldUrl=images.filter(function(img){return img.url;});if(!(status.content===content&&imgNewUrl.length===0&&imgOldUrl.length===status.images.length)){_context3.next=5;break;}return _context3.abrupt(\"return\");case 5:_context3.prev=5;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});if(!(imgNewUrl.length>0)){_context3.next=11;break;}_context3.next=10;return imageUpload(imgNewUrl);case 10:media=_context3.sent;case 11:_context3.next=13;return patchDataAPI(\"post/\".concat(status._id),{content:content,images:[].concat(_toConsumableArray(imgOldUrl),_toConsumableArray(media))},auth.token);case 13:res=_context3.sent;dispatch({type:POST_TYPES.UPDATE_POST,payload:res.data.newPost});dispatch({type:GLOBALTYPES.ALERT,payload:{success:res.data.msg}});_context3.next=21;break;case 18:_context3.prev=18;_context3.t0=_context3[\"catch\"](5);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context3.t0.response.data.msg}});case 21:case\"end\":return _context3.stop();}}},_callee3,null,[[5,18]]);}));return function(_x3){return _ref5.apply(this,arguments);};}();};export var likePost=function likePost(_ref6){var post=_ref6.post,auth=_ref6.auth,socket=_ref6.socket;return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var newPost,msg;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:newPost=_objectSpread(_objectSpread({},post),{},{likes:[].concat(_toConsumableArray(post.likes),[auth.user]),dislikes:post.dislikes.filter(function(dislike){return dislike._id!==auth.user._id;})});dispatch({type:POST_TYPES.UPDATE_POST,payload:newPost});socket.emit(\"likePost\",newPost);socket.emit(\"disLikePost\",newPost);_context4.prev=4;_context4.next=7;return patchDataAPI(\"post/\".concat(post._id,\"/like\"),null,auth.token);case 7:// todo notification\nmsg={id:auth.user._id,text:\"Liked your post.\",recipients:[post.user._id],url:\"/post/\".concat(post._id),content:post.content,image:post.images[0].url};dispatch(createNotify({msg:msg,auth:auth,socket:socket}));_context4.next=14;break;case 11:_context4.prev=11;_context4.t0=_context4[\"catch\"](4);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context4.t0.response.data.msg}});case 14:case\"end\":return _context4.stop();}}},_callee4,null,[[4,11]]);}));return function(_x4){return _ref7.apply(this,arguments);};}();};export var unLikePost=function unLikePost(_ref8){var post=_ref8.post,auth=_ref8.auth,socket=_ref8.socket;return/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var newPost,msg;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:newPost=_objectSpread(_objectSpread({},post),{},{likes:post.likes.filter(function(like){return like._id!==auth.user._id;})});dispatch({type:POST_TYPES.UPDATE_POST,payload:newPost});socket.emit(\"unLikePost\",newPost);_context5.prev=3;_context5.next=6;return patchDataAPI(\"post/\".concat(post._id,\"/unlike\"),null,auth.token);case 6:// todo notification\nmsg={id:auth.user._id,text:\"Liked your post.\",recipients:[post.user._id],url:\"/post/\".concat(post._id)};dispatch(removeNotify({msg:msg,auth:auth,socket:socket}));_context5.next=13;break;case 10:_context5.prev=10;_context5.t0=_context5[\"catch\"](3);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context5.t0.response.data.msg}});case 13:case\"end\":return _context5.stop();}}},_callee5,null,[[3,10]]);}));return function(_x5){return _ref9.apply(this,arguments);};}();};export var disLikePost=function disLikePost(_ref10){var post=_ref10.post,auth=_ref10.auth,socket=_ref10.socket;return/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var newPost;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:console.log(auth.user);newPost=_objectSpread(_objectSpread({},post),{},{likes:post.likes.filter(function(like){return like._id!==auth.user._id;}),dislikes:[].concat(_toConsumableArray(post.dislikes),[auth.user])});dispatch({type:POST_TYPES.UPDATE_POST,payload:newPost});socket.emit(\"disLikePost\",newPost);socket.emit(\"unLikePost\",newPost);_context6.prev=5;_context6.next=8;return patchDataAPI(\"post/\".concat(post._id,\"/dislike\"),null,auth.token);case 8:_context6.next=13;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](5);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context6.t0.response.data.msg}});case 13:case\"end\":return _context6.stop();}}},_callee6,null,[[5,10]]);}));return function(_x6){return _ref11.apply(this,arguments);};}();};export var unDisLikePost=function unDisLikePost(_ref12){var post=_ref12.post,auth=_ref12.auth,socket=_ref12.socket;return/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var newPost;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:newPost=_objectSpread(_objectSpread({},post),{},{dislikes:post.dislikes.filter(function(dislike){return dislike._id!==auth.user._id;})});dispatch({type:POST_TYPES.UPDATE_POST,payload:newPost});socket.emit(\"disLikePost\",newPost);_context7.prev=3;_context7.next=6;return patchDataAPI(\"post/\".concat(post._id,\"/undislike\"),null,auth.token);case 6:_context7.next=11;break;case 8:_context7.prev=8;_context7.t0=_context7[\"catch\"](3);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context7.t0.response.data.msg}});case 11:case\"end\":return _context7.stop();}}},_callee7,null,[[3,8]]);}));return function(_x7){return _ref13.apply(this,arguments);};}();};export var getPost=function getPost(_ref14){var detailPost=_ref14.detailPost,id=_ref14.id,auth=_ref14.auth;return/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(dispatch){var res;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!detailPost.every(function(post){return post._id!==id;})){_context8.next=11;break;}_context8.prev=1;_context8.next=4;return getDataAPI(\"post/\".concat(id),auth.token);case 4:res=_context8.sent;dispatch({type:POST_TYPES.GET_POST,payload:res.data.post});_context8.next=11;break;case 8:_context8.prev=8;_context8.t0=_context8[\"catch\"](1);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context8.t0.response.data.msg}});case 11:case\"end\":return _context8.stop();}}},_callee8,null,[[1,8]]);}));return function(_x8){return _ref15.apply(this,arguments);};}();};export var deletePost=function deletePost(_ref16){var post=_ref16.post,auth=_ref16.auth,socket=_ref16.socket;return/*#__PURE__*/function(){var _ref17=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(dispatch){var res,msg;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:dispatch({type:POST_TYPES.DELETE_POST,payload:post});_context9.prev=1;_context9.next=4;return deleteDataAPI(\"post/\".concat(post._id),auth.token);case 4:res=_context9.sent;// todo notification\nmsg={id:post._id,text:\"Added a new post.\",recipients:res.data.newPost.user.followers,url:\"/post/\".concat(post._id)};dispatch(removeNotify({msg:msg,auth:auth,socket:socket}));_context9.next=12;break;case 9:_context9.prev=9;_context9.t0=_context9[\"catch\"](1);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context9.t0.response.data.msg}});case 12:case\"end\":return _context9.stop();}}},_callee9,null,[[1,9]]);}));return function(_x9){return _ref17.apply(this,arguments);};}();};export var reportPost=function reportPost(_ref18){var post=_ref18.post,auth=_ref18.auth;return/*#__PURE__*/function(){var _ref19=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(dispatch){var reportExist,newPost,res;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:reportExist=post.reports.find(function(report){return report===auth.user._id;});if(!(reportExist&&reportExist.length>0)){_context10.next=3;break;}return _context10.abrupt(\"return\",dispatch({type:GLOBALTYPES.ALERT,payload:{error:\"You have already reported this post.\"}}));case 3:newPost=_objectSpread({},post);newPost.reports.push(auth.user._id);dispatch({type:POST_TYPES.REPORT_POST,payload:newPost});_context10.prev=6;_context10.next=9;return patchDataAPI(\"post/\".concat(post._id,\"/report\"),null,auth.token);case 9:res=_context10.sent;dispatch({type:GLOBALTYPES.ALERT,payload:{success:res.data.msg}});_context10.next=16;break;case 13:_context10.prev=13;_context10.t0=_context10[\"catch\"](6);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context10.t0.response.data.msg}});case 16:case\"end\":return _context10.stop();}}},_callee10,null,[[6,13]]);}));return function(_x10){return _ref19.apply(this,arguments);};}();};export var savePost=function savePost(_ref20){var post=_ref20.post,auth=_ref20.auth;return/*#__PURE__*/function(){var _ref21=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(dispatch){var newUser;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:newUser=_objectSpread(_objectSpread({},auth.user),{},{saved:[].concat(_toConsumableArray(auth.user.saved),[post._id])});dispatch({type:GLOBALTYPES.AUTH,payload:_objectSpread(_objectSpread({},auth),{},{user:newUser})});_context11.prev=2;_context11.next=5;return patchDataAPI(\"savePost/\".concat(post._id),null,auth.token);case 5:_context11.next=10;break;case 7:_context11.prev=7;_context11.t0=_context11[\"catch\"](2);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context11.t0.response.data.msg}});case 10:case\"end\":return _context11.stop();}}},_callee11,null,[[2,7]]);}));return function(_x11){return _ref21.apply(this,arguments);};}();};export var unSavePost=function unSavePost(_ref22){var post=_ref22.post,auth=_ref22.auth;return/*#__PURE__*/function(){var _ref23=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(dispatch){var newUser;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:newUser=_objectSpread(_objectSpread({},auth.user),{},{saved:auth.user.saved.filter(function(id){return id!==post._id;})});dispatch({type:GLOBALTYPES.AUTH,payload:_objectSpread(_objectSpread({},auth),{},{user:newUser})});_context12.prev=2;_context12.next=5;return patchDataAPI(\"unSavePost/\".concat(post._id),null,auth.token);case 5:_context12.next=10;break;case 7:_context12.prev=7;_context12.t0=_context12[\"catch\"](2);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context12.t0.response.data.msg}});case 10:case\"end\":return _context12.stop();}}},_callee12,null,[[2,7]]);}));return function(_x12){return _ref23.apply(this,arguments);};}();};","map":{"version":3,"sources":["C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/src/redux/actions/postAction.js"],"names":["GLOBALTYPES","postDataAPI","getDataAPI","patchDataAPI","deleteDataAPI","imageUpload","createNotify","removeNotify","POST_TYPES","CREATE_POST","LOADING_POST","GET_POSTS","UPDATE_POST","GET_POST","DELETE_POST","REPORT_POST","SAVE_POST","createPost","content","images","auth","socket","dispatch","media","type","ALERT","payload","loading","length","token","res","data","newPost","user","msg","id","_id","text","recipients","followers","url","image","console","log","error","response","getPosts","page","updatePost","status","imgNewUrl","filter","img","imgOldUrl","success","likePost","post","likes","dislikes","dislike","emit","unLikePost","like","disLikePost","unDisLikePost","getPost","detailPost","every","deletePost","reportPost","reportExist","reports","find","report","push","savePost","newUser","saved","AUTH","unSavePost"],"mappings":"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","sourcesContent":["import { GLOBALTYPES } from \"./globalTypes\";\nimport {\n  postDataAPI,\n  getDataAPI,\n  patchDataAPI,\n  deleteDataAPI,\n} from \"../../utils/fetchData\";\nimport { imageUpload } from \"../../utils/imageUpload\";\nimport { createNotify, removeNotify } from \"./notifyAction\";\n\nexport const POST_TYPES = {\n  CREATE_POST: \"CREATE_POST\",\n  LOADING_POST: \"LOADING_POST\",\n  GET_POSTS: \"GET_POSTS\",\n  UPDATE_POST: \"UPDATE_POST\",\n  GET_POST: \"GET_POST\",\n  DELETE_POST: \"DELETE_POST\",\n  REPORT_POST: \"REPORT_POST\",\n  SAVE_POST: \"SAVE_POST\",\n};\n\nexport const createPost =\n  ({ content, images, auth, socket }) =>\n  async (dispatch) => {\n    let media = [];\n\n    try {\n      dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: true } });\n\n      if (images.length > 0) {\n        media = await imageUpload(images);\n      }\n\n      const res = await postDataAPI(\n        \"posts\",\n        { content, images: media },\n        auth.token\n      );\n\n      dispatch({\n        type: POST_TYPES.CREATE_POST,\n        payload: { ...res.data.newPost, user: auth.user },\n      });\n\n      dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: false } });\n\n      // todo notification\n      const msg = {\n        id: res.data.newPost._id,\n        text: \"Added a new post.\",\n        recipients: res.data.newPost.user.followers,\n        url: `/post/${res.data.newPost._id}`,\n        content,\n        image: media[0].url,\n      };\n\n      dispatch(createNotify({ msg, auth, socket }));\n    } catch (err) {\n      console.log(err);\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const getPosts = (token) => async (dispatch) => {\n  console.log(token)\n  try {\n    dispatch({ type: POST_TYPES.LOADING_POST, payload: true });\n    const res = await getDataAPI(\"posts\", token);\n    console.log(res)\n    dispatch({ type: POST_TYPES.GET_POSTS, payload: { ...res.data, page: 2 } });\n\n    dispatch({ type: POST_TYPES.LOADING_POST, payload: false });\n  } catch (err) {\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: {\n        error: err.response.data.msg,\n      },\n    });\n  }\n};\n\nexport const updatePost =\n  ({ content, images, auth, status }) =>\n  async (dispatch) => {\n    let media = [];\n    const imgNewUrl = images.filter((img) => !img.url);\n    const imgOldUrl = images.filter((img) => img.url);\n    if (\n      status.content === content &&\n      imgNewUrl.length === 0 &&\n      imgOldUrl.length === status.images.length\n    ) {\n      return;\n    }\n    try {\n      dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: true } });\n      if (imgNewUrl.length > 0) {\n        media = await imageUpload(imgNewUrl);\n      }\n      const res = await patchDataAPI(\n        `post/${status._id}`,\n        { content, images: [...imgOldUrl, ...media] },\n        auth.token\n      );\n\n      dispatch({ type: POST_TYPES.UPDATE_POST, payload: res.data.newPost });\n      dispatch({ type: GLOBALTYPES.ALERT, payload: { success: res.data.msg } });\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const likePost =\n  ({ post, auth, socket }) =>\n  async (dispatch) => {\n    const newPost = {\n      ...post,\n      likes: [...post.likes, auth.user],\n      dislikes: post.dislikes.filter(\n        (dislike) => dislike._id !== auth.user._id\n      ),\n    };\n\n    dispatch({ type: POST_TYPES.UPDATE_POST, payload: newPost });\n    socket.emit(\"likePost\", newPost);\n    socket.emit(\"disLikePost\", newPost);\n\n    try {\n      await patchDataAPI(`post/${post._id}/like`, null, auth.token);\n\n      // todo notification\n      const msg = {\n        id: auth.user._id,\n        text: \"Liked your post.\",\n        recipients: [post.user._id],\n        url: `/post/${post._id}`,\n        content: post.content,\n        image: post.images[0].url,\n      };\n\n      dispatch(createNotify({ msg, auth, socket }));\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const unLikePost =\n  ({ post, auth, socket }) =>\n  async (dispatch) => {\n    const newPost = {\n      ...post,\n      likes: post.likes.filter((like) => like._id !== auth.user._id),\n    };\n\n    dispatch({ type: POST_TYPES.UPDATE_POST, payload: newPost });\n    socket.emit(\"unLikePost\", newPost);\n\n    try {\n      await patchDataAPI(`post/${post._id}/unlike`, null, auth.token);\n\n      // todo notification\n      const msg = {\n        id: auth.user._id,\n        text: \"Liked your post.\",\n        recipients: [post.user._id],\n        url: `/post/${post._id}`,\n      };\n\n      dispatch(removeNotify({ msg, auth, socket }));\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const disLikePost =\n  ({ post, auth, socket }) =>\n    async (dispatch) => {\n    console.log(auth.user);\n    const newPost = {\n      ...post,\n      likes: post.likes.filter((like) => like._id !== auth.user._id),\n      dislikes: [...post.dislikes, auth.user],\n    };\n\n    dispatch({ type: POST_TYPES.UPDATE_POST, payload: newPost });\n    socket.emit(\"disLikePost\", newPost);\n    socket.emit(\"unLikePost\", newPost);\n\n    try {\n      await patchDataAPI(`post/${post._id}/dislike`, null, auth.token);\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const unDisLikePost =\n  ({ post, auth, socket }) =>\n  async (dispatch) => {\n    const newPost = {\n      ...post,\n      dislikes: post.dislikes.filter(\n        (dislike) => dislike._id !== auth.user._id\n      ),\n    };\n\n    dispatch({ type: POST_TYPES.UPDATE_POST, payload: newPost });\n    socket.emit(\"disLikePost\", newPost);\n\n    try {\n      await patchDataAPI(`post/${post._id}/undislike`, null, auth.token);\n\n      // todo notification\n      // const msg = {\n      //   id: auth.user._id,\n      //   text: \"Liked your post.\",\n      //   recipients: [post.user._id],\n      //   url: `/post/${post._id}`,\n      // };\n\n      // dispatch(removeNotify({ msg, auth, socket }));\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const getPost =\n  ({ detailPost, id, auth }) =>\n  async (dispatch) => {\n    if (detailPost.every((post) => post._id !== id)) {\n      try {\n        const res = await getDataAPI(`post/${id}`, auth.token);\n        dispatch({ type: POST_TYPES.GET_POST, payload: res.data.post });\n      } catch (err) {\n        dispatch({\n          type: GLOBALTYPES.ALERT,\n          payload: {\n            error: err.response.data.msg,\n          },\n        });\n      }\n    }\n  };\n\nexport const deletePost =\n  ({ post, auth, socket }) =>\n  async (dispatch) => {\n    dispatch({ type: POST_TYPES.DELETE_POST, payload: post });\n\n    try {\n      const res = await deleteDataAPI(`post/${post._id}`, auth.token);\n\n      // todo notification\n      const msg = {\n        id: post._id,\n        text: \"Added a new post.\",\n        recipients: res.data.newPost.user.followers,\n        url: `/post/${post._id}`,\n      };\n\n      dispatch(removeNotify({ msg, auth, socket }));\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const reportPost =\n  ({ post, auth }) =>\n  async (dispatch) => {\n    const reportExist = post.reports.find((report) => report === auth.user._id);\n\n    if (reportExist && reportExist.length > 0) {\n      return dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: { error: \"You have already reported this post.\" },\n      });\n    }\n    const newPost = { ...post };\n    newPost.reports.push(auth.user._id);\n\n    dispatch({ type: POST_TYPES.REPORT_POST, payload: newPost });\n\n    try {\n      const res = await patchDataAPI(\n        `post/${post._id}/report`,\n        null,\n        auth.token\n      );\n      dispatch({ type: GLOBALTYPES.ALERT, payload: { success: res.data.msg } });\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const savePost =\n  ({ post, auth }) =>\n  async (dispatch) => {\n    const newUser = { ...auth.user, saved: [...auth.user.saved, post._id] };\n\n    dispatch({ type: GLOBALTYPES.AUTH, payload: { ...auth, user: newUser } });\n\n    try {\n      await patchDataAPI(`savePost/${post._id}`, null, auth.token);\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n\nexport const unSavePost =\n  ({ post, auth }) =>\n  async (dispatch) => {\n    const newUser = {\n      ...auth.user,\n      saved: auth.user.saved.filter((id) => id !== post._id),\n    };\n\n    dispatch({ type: GLOBALTYPES.AUTH, payload: { ...auth, user: newUser } });\n\n    try {\n      await patchDataAPI(`unSavePost/${post._id}`, null, auth.token);\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: {\n          error: err.response.data.msg,\n        },\n      });\n    }\n  };\n"]},"metadata":{},"sourceType":"module"}