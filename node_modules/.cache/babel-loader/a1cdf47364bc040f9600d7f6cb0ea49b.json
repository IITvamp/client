{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{postDataAPI,postDataAPIforRefreshToken}from\"../../utils/fetchData\";import{GLOBALTYPES}from\"./globalTypes\";import valid from\"../../utils/valid\";export var TYPES={AUTH:\"AUTH\"};export var login=function login(data){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});_context.next=4;return postDataAPI(\"login\",data);case 4:res=_context.sent;dispatch({type:GLOBALTYPES.AUTH,payload:{token:res.data.access_token,user:res.data.user}});dispatch({type:GLOBALTYPES.USER_TYPE,payload:res.data.user.role});localStorage.setItem(\"firstLogin\",true);dispatch({type:GLOBALTYPES.ALERT,payload:{success:res.data.msg}});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context.t0.response.data.msg}});case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var changePassword=function changePassword(_ref2){var oldPassword=_ref2.oldPassword,newPassword=_ref2.newPassword,cnfNewPassword=_ref2.cnfNewPassword,auth=_ref2.auth;return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!oldPassword||oldPassword.length===0){dispatch({type:GLOBALTYPES.ALERT,payload:{error:\"Please enter your old  password.\"}});}if(!newPassword||newPassword.length===0){dispatch({type:GLOBALTYPES.ALERT,payload:{error:\"Please enter your new  password.\"}});}if(!cnfNewPassword||cnfNewPassword.length===0){dispatch({type:GLOBALTYPES.ALERT,payload:{error:\"Please confirm your new  password.\"}});}if(newPassword!==cnfNewPassword){dispatch({type:GLOBALTYPES.ALERT,payload:{error:\"Your password does not match\"}});}_context2.prev=4;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});_context2.next=8;return postDataAPI('changePassword',{oldPassword:oldPassword,newPassword:newPassword},auth.token);case 8:res=_context2.sent;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:false}});dispatch({type:GLOBALTYPES.ALERT,payload:{success:res.data.msg}});_context2.next=16;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](4);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context2.t0.response.data.msg}});case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[4,13]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};export var adminLogin=function adminLogin(data){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});_context3.next=4;return postDataAPI(\"admin_login\",data);case 4:res=_context3.sent;dispatch({type:GLOBALTYPES.AUTH,payload:{token:res.data.access_token,user:res.data.user}});dispatch({type:GLOBALTYPES.USER_TYPE,payload:res.data.user.role});localStorage.setItem(\"firstLogin\",true);dispatch({type:GLOBALTYPES.ALERT,payload:{success:res.data.msg}});_context3.next=14;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](0);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context3.t0.response.data.msg}});case 14:case\"end\":return _context3.stop();}}},_callee3,null,[[0,11]]);}));return function(_x3){return _ref4.apply(this,arguments);};}();};export var refreshToken=function refreshToken(){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var firstLogin,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:firstLogin=localStorage.getItem(\"firstLogin\");console.log(\"refreshing\");if(!firstLogin){_context4.next=16;break;}dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});_context4.prev=4;_context4.next=7;return postDataAPI(\"refresh_token\");case 7:res=_context4.sent;dispatch({type:GLOBALTYPES.AUTH,payload:{token:res.data.access_token,user:res.data.user}});dispatch({type:GLOBALTYPES.USER_TYPE,payload:res.data.user.role});dispatch({type:GLOBALTYPES.ALERT,payload:{}});_context4.next=16;break;case 13:_context4.prev=13;_context4.t0=_context4[\"catch\"](4);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context4.t0.response.data.msg}});case 16:case\"end\":return _context4.stop();}}},_callee4,null,[[4,13]]);}));return function(_x4){return _ref5.apply(this,arguments);};}();};export var register=function register(data){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var check,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:check=valid(data);if(!(check.errLength>0)){_context5.next=3;break;}return _context5.abrupt(\"return\",dispatch({type:GLOBALTYPES.ALERT,payload:check.errMsg}));case 3:_context5.prev=3;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});_context5.next=7;return postDataAPI(\"register\",data);case 7:res=_context5.sent;dispatch({type:GLOBALTYPES.AUTH,payload:{token:res.data.access_token,user:res.data.user}});dispatch({type:GLOBALTYPES.USER_TYPE,payload:res.data.user.role});localStorage.setItem(\"firstLogin\",true);dispatch({type:GLOBALTYPES.ALERT,payload:{success:res.data.msg}});_context5.next=17;break;case 14:_context5.prev=14;_context5.t0=_context5[\"catch\"](3);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context5.t0.response.data.msg}});case 17:case\"end\":return _context5.stop();}}},_callee5,null,[[3,14]]);}));return function(_x5){return _ref6.apply(this,arguments);};}();};export var registerAdmin=function registerAdmin(data){return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var check,res;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:check=valid(data);if(!(check.errLength>0)){_context6.next=3;break;}return _context6.abrupt(\"return\",dispatch({type:GLOBALTYPES.ALERT,payload:check.errMsg}));case 3:_context6.prev=3;dispatch({type:GLOBALTYPES.ALERT,payload:{loading:true}});_context6.next=7;return postDataAPI(\"register_admin\",data);case 7:res=_context6.sent;dispatch({type:GLOBALTYPES.ALERT,payload:{success:res.data.msg}});_context6.next=14;break;case 11:_context6.prev=11;_context6.t0=_context6[\"catch\"](3);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context6.t0.response.data.msg}});case 14:case\"end\":return _context6.stop();}}},_callee6,null,[[3,11]]);}));return function(_x6){return _ref7.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;localStorage.removeItem(\"firstLogin\");_context7.next=4;return postDataAPI(\"logout\");case 4:window.location.href=\"/\";_context7.next=10;break;case 7:_context7.prev=7;_context7.t0=_context7[\"catch\"](0);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context7.t0.response.data.msg}});case 10:case\"end\":return _context7.stop();}}},_callee7,null,[[0,7]]);}));return function(_x7){return _ref8.apply(this,arguments);};}();};","map":{"version":3,"sources":["C:/Users/ayush/Desktop/myProjects/mern-social-media-master/client/src/redux/actions/authAction.js"],"names":["postDataAPI","postDataAPIforRefreshToken","GLOBALTYPES","valid","TYPES","AUTH","login","data","dispatch","type","ALERT","payload","loading","res","token","access_token","user","USER_TYPE","role","localStorage","setItem","success","msg","error","response","changePassword","oldPassword","newPassword","cnfNewPassword","auth","length","adminLogin","refreshToken","firstLogin","getItem","console","log","register","check","errLength","errMsg","registerAdmin","logout","removeItem","window","location","href"],"mappings":"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","sourcesContent":["import { postDataAPI, postDataAPIforRefreshToken } from \"../../utils/fetchData\";\nimport { GLOBALTYPES } from \"./globalTypes\";\nimport valid from \"../../utils/valid\";\n\nexport const TYPES = {\n  AUTH: \"AUTH\",\n};\n\nexport const login = (data) => async (dispatch) => {\n  try {\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: true } });\n    const res = await postDataAPI(\"login\", data);\n\n    dispatch({\n      type: GLOBALTYPES.AUTH,\n      payload: { token: res.data.access_token, user: res.data.user },\n    });\n\n    dispatch({\n      type: GLOBALTYPES.USER_TYPE,\n      payload: res.data.user.role,\n    });\n\n    localStorage.setItem(\"firstLogin\", true);\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { success: res.data.msg } });\n  } catch (err) {\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: err.response.data.msg },\n    });\n  }\n};\n\nexport const changePassword = ({oldPassword, newPassword, cnfNewPassword, auth}) => async (dispatch) => {\n\n  if(!oldPassword || oldPassword.length === 0){\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: \"Please enter your old  password.\" },\n    });\n  }\n  if(!newPassword || newPassword.length === 0){\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: \"Please enter your new  password.\" },\n    });\n  }\n  if(!cnfNewPassword || cnfNewPassword.length === 0){\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: \"Please confirm your new  password.\" },\n    });\n  }\n  if(newPassword !==cnfNewPassword){\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: \"Your password does not match\" },\n    });\n  }\n  \n  try {\n    \n    \n\n    dispatch({ type: GLOBALTYPES.ALERT, payload: {loading: true} });\n\n    const res = await postDataAPI('changePassword', {oldPassword, newPassword}, auth.token );\n\n    dispatch({ type: GLOBALTYPES.ALERT, payload: {loading: false} });\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { success: res.data.msg } });\n  } catch (err) {\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: err.response.data.msg },\n    });\n  }\n};\n\nexport const adminLogin = (data) => async (dispatch) => {\n  try {\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: true } });\n    const res = await postDataAPI(\"admin_login\", data);\n\n    dispatch({\n      type: GLOBALTYPES.AUTH,\n      payload: { token: res.data.access_token, user: res.data.user },\n    });\n\n    dispatch({\n      type: GLOBALTYPES.USER_TYPE,\n      payload: res.data.user.role,\n    });\n\n    localStorage.setItem(\"firstLogin\", true);\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { success: res.data.msg } });\n  } catch (err) {\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: err.response.data.msg },\n    });\n  }\n};\n\nexport const refreshToken = () => async (dispatch) => {\n  const firstLogin = localStorage.getItem(\"firstLogin\");\n  console.log(\"refreshing\")\n  if (firstLogin) {\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: true } });\n    try {\n      const res = await postDataAPI(\"refresh_token\");\n      dispatch({\n        type: GLOBALTYPES.AUTH,\n        payload: { token: res.data.access_token, user: res.data.user },\n      });\n\n      dispatch({\n        type: GLOBALTYPES.USER_TYPE,\n        payload: res.data.user.role,\n      });\n\n      dispatch({ type: GLOBALTYPES.ALERT, payload: {} });\n    } catch (err) {\n      dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: { error: err.response.data.msg },\n      });\n    }\n  }\n};\n\nexport const register = (data) => async (dispatch) => {\n  const check = valid(data);\n  if (check.errLength > 0) {\n    return dispatch({ type: GLOBALTYPES.ALERT, payload: check.errMsg });\n  }\n\n  try {\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: true } });\n\n    const res = await postDataAPI(\"register\", data);\n\n    dispatch({\n      type: GLOBALTYPES.AUTH,\n      payload: { token: res.data.access_token, user: res.data.user },\n    });\n\n    dispatch({\n      type: GLOBALTYPES.USER_TYPE,\n      payload: res.data.user.role,\n    });\n\n    localStorage.setItem(\"firstLogin\", true);\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { success: res.data.msg } });\n  } catch (err) {\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: err.response.data.msg },\n    });\n  }\n};\n\nexport const registerAdmin = (data) => async (dispatch) => {\n  const check = valid(data);\n  if (check.errLength > 0) {\n    return dispatch({ type: GLOBALTYPES.ALERT, payload: check.errMsg });\n  }\n\n  try {\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { loading: true } });\n\n    const res = await postDataAPI(\"register_admin\", data);\n\n    dispatch({ type: GLOBALTYPES.ALERT, payload: { success: res.data.msg } });\n  } catch (err) {\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: err.response.data.msg },\n    });\n  }\n};\n\nexport const logout = () => async (dispatch) => {\n  try {\n    localStorage.removeItem(\"firstLogin\");\n\n    await postDataAPI(\"logout\");\n    window.location.href = \"/\";\n  } catch (err) {\n    dispatch({\n      type: GLOBALTYPES.ALERT,\n      payload: { error: err.response.data.msg },\n    });\n  }\n};\n"]},"metadata":{},"sourceType":"module"}